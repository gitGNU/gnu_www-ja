<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.52
     from ../texi/nana.texi on 6 November 1998 -->

<TITLE>GNU Nana: improved support for assertions and logging in C and C++ - calls.h</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="nana_1.html">first</A>, <A HREF="nana_30.html">previous</A>, <A HREF="nana_32.html">next</A>, <A HREF="nana_42.html">last</A> section, <A HREF="nana_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC31" HREF="nana_toc.html#TOC31">calls.h: checking/printing many objects/facts.</A></H2>
<P>
The <SAMP>`calls'</SAMP> module implements a simple list of functions which can be 
modified and executed at run-time. It is similar in spirit to the 
ANSI C <SAMP>`atexit'</SAMP> function. It is intended to be used for: 

</P>

<UL>
<LI>Checking the consistency of the components in your system.

For example each module could register a self checking function which
uses the rest of the nana library. All of these functions would then be
called using <SAMP>`calls.h'</SAMP> to check that the entire system is consistent.

<LI>Printing out the state of your program in a readable format.

</UL>

<P>
<DL>
<DT><U>Type:</U> <B>typedef</B> <I>FUNC</I>
<DD><A NAME="IDX180"></A>
A pointer to a <SAMP>`void'</SAMP> function which takes a single <SAMP>`void*'</SAMP>
argument. The <SAMP>`void *'</SAMP> argument is intended to be used to pass
information such as arguments or pointers to objects (e.g. <SAMP>`this'</SAMP>
in C++). All of the checking/printing functions must be of this type, e.g.

</P>

<PRE>
void print_object(void *f) {
  ...;
}
</PRE>

</DL>

<P>
<DL>
<DT><U>Type:</U> <B>struct</B> <I>CALL</I>
<DD><A NAME="IDX181"></A>
This structure represents a single call to a function, i.e. a function 
pointer (<SAMP>`FUNC'</SAMP>) and the <SAMP>`void*'</SAMP> argument. 

</P>

<PRE>
	CALL *head = 0;
</PRE>

</DL>

<P>
<DL>
<DT><U>Function:</U> void <B>calls_add</B> <I>(CALL **head, FUNC fp, *arg)</I>
<DD><A NAME="IDX182"></A>
Adds a call to function <SAMP>`fp'</SAMP> with argument <SAMP>`arg'</SAMP> to
the list pointed to by <SAMP>`head'</SAMP>. 

</P>

<PRE>
	CALL *global_checks = 0;

	calls_add(&#38;global_checks,complex_ok,(void *)x); 
</PRE>

</DL>

<P>
<DL>
<DT><U>Function:</U> void <B>calls_exec</B> <I>(CALL **head, FUNC fp, void *arg)</I>
<DD><A NAME="IDX183"></A>
Execute all/some of the calls in the list given by <SAMP>`head'</SAMP>.
The arguments <SAMP>`fp'</SAMP> and <SAMP>`arg'</SAMP> must both
match for each individual call. The null pointer (<SAMP>`0'</SAMP>) matches 
anything whilst any other value requires an exact match between
the <SAMP>`CALL'</SAMP> and the arguments to <SAMP>`calls_exec'</SAMP>. 
For example:

</P>

<PRE>
calls_exec(&#38;l,0,0); /* execute all functions in l  */
calls_exec(&#38;l,complex_print,0); /* calls complex_print(*) in l */
calls_exec(&#38;l,0,(void*) &#38;b); /* calls *(&#38;b) in l */
calls_exec(&#38;l,f,(void*) &#38;b); /* calls f(&#38;b) in l */
</PRE>

</DL>

<P>
<DL>
<DT><U>Function:</U> void <B>calls_delete</B> <I>(CALL **head, FUNC fp, void *arg)</I>
<DD><A NAME="IDX184"></A>
Delete all/some of the calls in the list given by <SAMP>`head'</SAMP>.
The arguments <SAMP>`fp'</SAMP> and <SAMP>`arg'</SAMP> must both
match for each individual call. The null pointer (<SAMP>`0'</SAMP>) matches 
anything whilst any other value requires an exact match between
the <SAMP>`CALL'</SAMP> and the arguments to <SAMP>`calls_delete'</SAMP>. 
For example:

</P>

<PRE>
calls_delete(&#38;l,0,0); /* delete all functions in l  */
calls_delete(&#38;l,complex_print,0); /* delete complex_print(*) in l */
calls_delete(&#38;l,0,(void*) &#38;b); /* delete *(&#38;b) in l */
calls_delete(&#38;l,f,(void*) &#38;b); /* delete f(&#38;b) in l */
</PRE>

</DL>

<P>
<STRONG>Note:</STRONG> that calls are added to the head of the list rather than the 
tail. This means that the most recently added call will be 
executed first (as in a stack).

</P>
<P><HR><P>
Go to the <A HREF="nana_1.html">first</A>, <A HREF="nana_30.html">previous</A>, <A HREF="nana_32.html">next</A>, <A HREF="nana_42.html">last</A> section, <A HREF="nana_toc.html">table of contents</A>.
</BODY>
</HTML>
