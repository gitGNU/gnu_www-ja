<html lang="en">
<head>
<title>GNU MP 4.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="How to install and use the GNU multiple precision arithmetic library, version 4.1.">
<meta name=generator content="makeinfo 4.2">
<link href="http://www.gnu.org/software/texinfo/" rel=generator-home>
<!--
This manual describes how to install and use the GNU multiple precision
arithmetic library, version 4.1.

<p>Copyright 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002
Free Software Foundation, Inc.

<p>Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant Sections,
with the Front-Cover Texts being "A GNU Manual", and with the Back-Cover
Texts being "You have freedom to copy and modify this GNU Manual, like GNU
software".  A copy of the license is included in <a href="GNU-Free-Documentation-License.html#GNU%20Free%20Documentation%20License">GNU Free Documentation License</a>.-->
</head>
<body>
<p>
Node:<a name="Basecase%20Multiplication">Basecase Multiplication</a>,
Next:<a rel=next accesskey=n href="Karatsuba-Multiplication.html#Karatsuba%20Multiplication">Karatsuba Multiplication</a>,
Previous:<a rel=previous accesskey=p href="Multiplication-Algorithms.html#Multiplication%20Algorithms">Multiplication Algorithms</a>,
Up:<a rel=up accesskey=u href="Multiplication-Algorithms.html#Multiplication%20Algorithms">Multiplication Algorithms</a>
<hr><br>

<h4>Basecase Multiplication</h4>

<p>Basecase NxM multiplication is a straightforward rectangular set of
cross-products, the same as long multiplication done by hand and for that
reason sometimes known as the schoolbook or grammar school method.  This is an
O(N*M) algorithm.  See Knuth section 4.3.1 algorithm M
(see <a href="References.html#References">References</a>), and the <code>mpn/generic/mul_basecase.c</code> code.

<p>Assembler implementations of <code>mpn_mul_basecase</code> are essentially the same
as the generic C code, but have all the usual assembler tricks and
obscurities introduced for speed.

<p>A square can be done in roughly half the time of a multiply, by using the fact
that the cross products above and below the diagonal are the same.  A triangle
of products below the diagonal is formed, doubled (left shift by one bit), and
then the products on the diagonal added.  This can be seen in
<code>mpn/generic/sqr_basecase.c</code>.  Again the assembler implementations take
essentially the same approach.

<br><pre>     u0  u1  u2  u3  u4
   +---+---+---+---+---+
u0 | d |   |   |   |   |
   +---+---+---+---+---+
u1 |   | d |   |   |   |
   +---+---+---+---+---+
u2 |   |   | d |   |   |
   +---+---+---+---+---+
u3 |   |   |   | d |   |
   +---+---+---+---+---+
u4 |   |   |   |   | d |
   +---+---+---+---+---+
</pre>

<p>In practice squaring isn't a full 2x faster than multiplying, it's
usually around 1.5x.  Less than 1.5x probably indicates
<code>mpn_sqr_basecase</code> wants improving on that CPU.

<p>On some CPUs <code>mpn_mul_basecase</code> can be faster than the generic C
<code>mpn_sqr_basecase</code>.  <code>SQR_BASECASE_THRESHOLD</code> is the size at which
to use <code>mpn_sqr_basecase</code>, this will be zero if that routine should be
used always.

</body></html>

