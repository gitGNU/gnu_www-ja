<html lang="en">
<head>
<title>GNU MP 4.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="How to install and use the GNU multiple precision arithmetic library, version 4.1.">
<meta name=generator content="makeinfo 4.2">
<link href="http://www.gnu.org/software/texinfo/" rel=generator-home>
<!--
This manual describes how to install and use the GNU multiple precision
arithmetic library, version 4.1.

<p>Copyright 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002
Free Software Foundation, Inc.

<p>Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant Sections,
with the Front-Cover Texts being "A GNU Manual", and with the Back-Cover
Texts being "You have freedom to copy and modify this GNU Manual, like GNU
software".  A copy of the license is included in <a href="GNU-Free-Documentation-License.html#GNU%20Free%20Documentation%20License">GNU Free Documentation License</a>.-->
</head>
<body>
<p>
Node:<a name="Binomial%20Coefficients%20Algorithm">Binomial Coefficients Algorithm</a>,
Next:<a rel=next accesskey=n href="Fibonacci-Numbers-Algorithm.html#Fibonacci%20Numbers%20Algorithm">Fibonacci Numbers Algorithm</a>,
Previous:<a rel=previous accesskey=p href="Factorial-Algorithm.html#Factorial%20Algorithm">Factorial Algorithm</a>,
Up:<a rel=up accesskey=u href="Other-Algorithms.html#Other%20Algorithms">Other Algorithms</a>
<hr><br>

<h4>Binomial Coefficients</h4>

<p>Binomial coefficients C(n,k) are calculated
by first arranging k &lt;= n/2 using C(n,k) = C(n,n-k) if necessary, and then
evaluating the following product simply from i=2 to i=k.

<br><pre>                      k  (n-k+i)
C(n,k) =  (n-k+1) * prod -------
                     i=2    i
</pre>

<p>It's easy to show that each denominator i will divide the product so
far, so the exact division algorithm is used (see <a href="Exact-Division.html#Exact%20Division">Exact Division</a>).

<p>The numerators n-k+i and denominators i are first accumulated
into as many fit a limb, to save multi-precision operations, though for
<code>mpz_bin_ui</code> this applies only to the divisors, since n is an
<code>mpz_t</code> and n-k+i in general won't fit in a limb at all.

<p>An obvious improvement would be to strip factors of 2 from each multiplier and
divisor and count them separately, to be applied with a bit shift at the end. 
Factors of 3 and perhaps 5 could even be handled similarly.  Another
possibility, if n is not too big, would be to determine the prime
factorization of the result based on the factorials involved, and power up
those primes appropriately.  This would help most when k is near
n/2.

</body></html>

