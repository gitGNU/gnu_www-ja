<html lang="en">
<head>
<title>GNU MP 4.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="How to install and use the GNU multiple precision arithmetic library, version 4.1.">
<meta name=generator content="makeinfo 4.2">
<link href="http://www.gnu.org/software/texinfo/" rel=generator-home>
<!--
This manual describes how to install and use the GNU multiple precision
arithmetic library, version 4.1.

<p>Copyright 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002
Free Software Foundation, Inc.

<p>Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant Sections,
with the Front-Cover Texts being "A GNU Manual", and with the Back-Cover
Texts being "You have freedom to copy and modify this GNU Manual, like GNU
software".  A copy of the license is included in <a href="GNU-Free-Documentation-License.html#GNU%20Free%20Documentation%20License">GNU Free Documentation License</a>.-->
</head>
<body>
<p>
Node:<a name="Factorial%20Algorithm">Factorial Algorithm</a>,
Next:<a rel=next accesskey=n href="Binomial-Coefficients-Algorithm.html#Binomial%20Coefficients%20Algorithm">Binomial Coefficients Algorithm</a>,
Previous:<a rel=previous accesskey=p href="Other-Algorithms.html#Other%20Algorithms">Other Algorithms</a>,
Up:<a rel=up accesskey=u href="Other-Algorithms.html#Other%20Algorithms">Other Algorithms</a>
<hr><br>

<h4>Factorial</h4>

<p>Factorials n! are calculated by a simple product from 1 to
n, but arranged into certain sub-products.

<p>First as many factors as fit in a limb are accumulated, then two of those
multiplied to give a 2-limb product.  When two 2-limb products are ready
they're multiplied to a 4-limb product, and when two 4-limbs are ready they're
multiplied to an 8-limb product, etc.  A stack of outstanding products is
built up, with two of the same size multiplied together when ready.

<p>Arranging for multiplications to have operands the same (or nearly the same)
size means the Karatsuba and higher multiplication algorithms can be used. 
And even on sizes below the Karatsuba threshold an NxN multiply will
give a basecase multiply more to work on.

<p>An obvious improvement not currently implemented would be to strip factors of
2 from the products and apply them at the end with a bit shift.  Another
possibility would be to determine the prime factorization of the result (which
can be done easily), and use a powering method, at each stage squaring then
multiplying in those primes with a 1 in their exponent at that point.  The
advantage would be some multiplies turned into squares.

</body></html>

