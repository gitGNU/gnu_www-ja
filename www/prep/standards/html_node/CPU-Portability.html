<html lang="en">
<head>
<title>CPU Portability - GNU Coding Standards</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Coding Standards">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Writing-C.html#Writing-C" title="Writing C">
<link rel="prev" href="System-Portability.html#System-Portability" title="System Portability">
<link rel="next" href="System-Functions.html#System-Functions" title="System Functions">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
The GNU coding standards, last updated April 7, 2012.

Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front-Cover Texts, and with no Back-Cover
Texts.  A copy of the license is included in the section entitled
``GNU Free Documentation License''.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="CPU-Portability"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="System-Functions.html#System-Functions">System Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="System-Portability.html#System-Portability">System Portability</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Writing-C.html#Writing-C">Writing C</a>
<hr>
</div>

<h3 class="section">5.6 Portability between <span class="sc">cpu</span>s</h3>

<p><a name="index-data-types_002c-and-portability-104"></a><a name="index-portability_002c-and-data-types-105"></a>Even GNU systems will differ because of differences among <span class="sc">cpu</span>
types&mdash;for example, difference in byte ordering and alignment
requirements.  It is absolutely essential to handle these differences. 
However, don't make any effort to cater to the possibility that an
<code>int</code> will be less than 32 bits.  We don't support 16-bit machines
in GNU.

   <p>Similarly, don't make any effort to cater to the possibility that
<code>long</code> will be smaller than predefined types like <code>size_t</code>. 
For example, the following code is ok:

<pre class="example">     printf ("size = %lu\n", (unsigned long) sizeof array);
     printf ("diff = %ld\n", (long) (pointer2 - pointer1));
</pre>
   <p>1989 Standard C requires this to work, and we know of only one
counterexample: 64-bit programs on Microsoft Windows.  We will leave
it to those who want to port GNU programs to that environment to
figure out how to do it.

   <p>Predefined file-size types like <code>off_t</code> are an exception: they are
longer than <code>long</code> on many platforms, so code like the above won't
work with them.  One way to print an <code>off_t</code> value portably is to
print its digits yourself, one by one.

   <p>Don't assume that the address of an <code>int</code> object is also the
address of its least-significant byte.  This is false on big-endian
machines.  Thus, don't make the following mistake:

<pre class="example">     int c;
     ...
     while ((c = getchar ()) != EOF)
       write (file_descriptor, &amp;c, 1);
</pre>
   <p class="noindent">Instead, use <code>unsigned char</code> as follows.  (The <code>unsigned</code>
is for portability to unusual systems where <code>char</code> is signed and
where there is integer overflow checking.)

<pre class="example">     int c;
     while ((c = getchar ()) != EOF)
       {
         unsigned char u = c;
         write (file_descriptor, &amp;u, 1);
       }
</pre>
   <p><a name="index-casting-pointers-to-integers-106"></a>Avoid casting pointers to integers if you can.  Such casts greatly
reduce portability, and in most programs they are easy to avoid.  In the
cases where casting pointers to integers is essential&mdash;such as, a Lisp
interpreter which stores type information as well as an address in one
word&mdash;you'll have to make explicit provisions to handle different word
sizes.  You will also need to make provision for systems in which the
normal range of addresses you can get from <code>malloc</code> starts far away
from zero.

   </body></html>

